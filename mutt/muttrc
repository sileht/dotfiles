
source ~/.mutt/colors
#source ~/.mutt/mutt-colors-solarized/mutt-colors-solarized-dark-256.muttrc
source ~/.mutt/keybinding

set hostname=sileht.net
set mime_forward=yes
set mime_forward_rest=yes
set mbox_type=Maildir

set my_account_sileht = "imaps://mail.sileht.net"
set my_account_enovance = "imaps://zimbra.enovance.com"
set my_account_ttnn = "imaps://common@mx1.tetaneutral.net"
set my_account_ttnn_system = "imaps://system@mx1.tetaneutral.net"

source ~/.mutt/password
account-hook '.' 'source ~/.mutt/account.reset'

#folder-hook '.' 'source ~/.mutt/account.reset'
folder-hook $my_account_sileht 'source ~/.mutt/account.sileht'
folder-hook $my_account_enovance  'source ~/.mutt/account.enovance'
folder-hook $my_account_ttnn 'source ~/.mutt/account.ttnn'
folder-hook $my_account_ttnn_system 'source ~/.mutt/account.ttnn-system'

account-hook $my_account_sileht 'source ~/.mutt/account.sileht'
account-hook $my_account_enovance  'source ~/.mutt/account.enovance'
account-hook $my_account_ttnn 'source ~/.mutt/account.ttnn'
account-hook $my_account_ttnn_system 'source ~/.mutt/account.ttnn-system'

source ~/.mutt/account.sileht

set my_reset="<enter-command>source ~/.mutt/account.reset<enter>"

macro index,pager <f2> "$my_reset<change-folder>$my_account_sileht/INBOX<enter>"
macro index,pager <f3> "$my_reset<change-folder>$my_account_enovance/INBOX<enter>"
macro index,pager <f4> "$my_reset<change-folder>$my_account_ttnn<enter>"
macro index,pager <f5> "$my_reset<change-folder>$my_account_ttnn_system<enter>"

set ssl_starttls=yes

set imap_idle="yes"
set imap_keepalive = 300
set imap_passive = no
set imap_check_subscribed = yes    # Automatically poll subscribed mailboxes for new mail (new in 1.5.11)

set mail_check = 60           # Reduce polling frequency to a sane level
set timeout = 10              # And poll the current mailbox more often (not needed with IDLE in post 1.5.11)
set net_inc = 5               # Display download progress every 5K

set my_tprot='t-prot -aelmtSsw -c --bigq=10,4 -Mmutt --pgp-move --spass -L$HOME/.mutt/mlfooters -A$HOME/.mutt/adfooters'
set display_filter=$my_tprot

macro generic \e0 ":unset display_filter\n" "Turn TOFU protection off"
macro generic \e1 ":set display_filter='$my_tprot'\n" "Turn TOFU protection on"
macro pager \e0 ":unset display_filter; exec exit\n:exec display-message\n" "Turn TOFU protection off"
macro pager \e1 ":set display_filter='$my_tprot'; exec exit\n:exec display-message\n" "Turn TOFU protection on"

# highlight TOFU protection:
color body    brightmagenta   black   "^\\[---.*"
color body    green           black   "^#v[-+]""]"
set editor='vim + -c "set textwidth=72" -c "set wrap" -c "set spell spelllang=fr,en" -c "set nocp" -c "startinsert" -c "?^$"'

set folder=""
set move = no                   # Stop asking to "move read messages to mbox"!
set copy = yes                  # always save a copy of outgoing messages
set delete = yes            # purge deleted messages without asking
set edit_headers =yes           # let me edit the message header when composing
set include = yes               # always include messages when replying
set forward_quote = yes         # include original text on forward?
set indent_string = "> "        # how to quote replied text
set mail_check = 10             # how often to poll for new mail
set mark_old = no               # i don't care about whether a message is old
set narrow_tree = yes           # narrow threading trees
set collapse_unread = no        # don't collapse threads with unread mails
set uncollapse_jump = yes       # jump to unread message when uncollapse
set sort=threads
set sort_browser=reverse-date # showing mbox list default to newest first
set sort_aux=last-date-received # showing threads with youngest message last

set auto_tag = yes


set duplicate_threads = yes
folder-hook . push "<delete-pattern>~=<enter>"
#folder-hook . push "<delete-pattern>~=<enter>$"
folder-hook . 'set record="^"'

set abort_nosubject = yes
set metoo = no                  # remove my address when replying

set folder_format="%2C %t %N %8s %d %f"  # what I settled on

#auto_view text/html
set mailcap_path="~/.mutt/mailcap"
set certificate_file="~/.mutt/certificates"

# Contacts
set alias_file = ".mutt/aliases"
#set query_command="~/.bin/pc_query -m '%s'"
set query_command="lbdbq '%s'"

set sidebar_width=30
set sidebar_visible=yes
set sidebar_delim=' '
set sidebar_sort=yes

set pager_index_lines = 12 # Split-screen index/pager preview thing
set pager_stop = yes       # Don't skip to next message at end of message
                           # (avoids accidental setting as being read)      
set markers = no           # no line wraparound marker (is "+" by default)

# You can show/hide headers (blacklisted and whitelisted). 
# For example, if you only want to see a few headers:
ignore *
unignore Date: From: Organization: To: Cc: Reply-To: Subject:
unignore x-mailing-list: posted-to:
unignore x-mailer: user-agent:

# If you're doing that for readability, you probably also want to 
# reorder them for skimmability:
hdr_order Date: Subject: From: To: Cc:  Reply-To: Organization:
folder-hook . set sort=threads   # Set threaded pager as default for all folders
folder-hook . 'set read_inc=1000'
folder-hook ^imap 'set read_inc=100' 

set header_cache = "~/.mutt/cache/headers"
set message_cachedir = "~/.mutt/cache/messages"
