
set debug_file = "/home/sileht/.mutt/log"
set debug_level = 0

source ~/.mutt/vombatidae.mutt
source ~/.mutt/crypto
source ~/.mutt/keybinding

set charset = "utf-8"
set hostname = sileht.net
set mbox_type = Maildir
set xterm_set_titles = yes

set ssl_starttls = yes
set imap_idle = yes
set imap_keepalive = 600

set net_inc = 5               # Display download progress every 5K
set read_inc = 0
set read_inc = 0
folder-hook . 'set read_inc=0'
#folder-hook (^imap://mail.sileht.net) 'set read_inc=1000'

set editor='vim + '                     # email editing option are set into vimrc with /tmp/mutt_* catcher
set edit_headers =yes                   # let me edit the message header when composing

# Don't bother me with stupid question
set move = no                           # Stop asking to "move read messages to mbox"!
set sleep_time = 0                      # Don't wait on notification
set copy = yes                          # always save a copy of outgoing messages
set delete = yes                        # purge deleted messages without asking
# reply
set include = yes                       # always include messages when replying
set fast_reply=yes                      # no prompting on reply
# forward
set forward_quote = yes                 # include original text on forward?
set mime_forward=yes                    # forward everything
set mime_forward_rest=yes               # forward everything and more
set indent_string = "> "                # how to quote replied text

set mail_check = 20                     # how often to poll for new mail
set mail_check_stats = yes              # Get stats about new mail, needed by sidebar
set mail_check_recent = no              # Use New flag and not last visited date

# Index
set mark_old = no                       # i don't care about whether a message is old
set narrow_tree = yes                   # narrow threading trees
set nowait_key
set collapse_unread = no                # don't collapse threads with unread mails
set strict_threads = yes
set uncollapse_new = yes                # open threads when new mail
set uncollapse_jump = yes               # jump to unread message when uncollapse
set status_on_top = yes                 # status bar on top
set sort=threads
folder-hook . set sort=threads          # Set threaded pager as default for all folders
set sort_browser=date                   # showing mbox list default to newest first
set sort_aux=reverse-last-date-received # showing threads with youngest message last

# Message display
set my_tprot='t-prot -aelmtSsw -c --bigq=10,4 -Mmutt --pgp-move --spass -L$HOME/.mutt/mlfooters -A$HOME/.mutt/adfooters'
set display_filter=$my_tprot
set skip_quoted_offset = 3
set text_flowed=yes

macro generic ) ":unset display_filter\n" "Turn TOFU protection off"
macro generic = ":set display_filter='$my_tprot'\n" "Turn TOFU protection on"
macro pager ) ":unset display_filter; exec exit\n:exec display-message\n" "Turn TOFU protection off"
macro pager = ":set display_filter='$my_tprot'; exec exit\n:exec display-message\n" "Turn TOFU protection on"

set duplicate_threads = no              # Do it only for some accounts
folder-hook . push "<delete-pattern>~=<enter>"

set hidden_tags=Junk,NonJunk,nonjunk,junk,\$Forwarded,\$label1,\$label2,\$label3,\$label4
tag-transforms "telemetry" "⌬ " "oslo" "⛁ "
set index_format=" [%Z] %{%b-%d %H:%M} | %-20.20L | %?M?➘ ?%s %?g?/ %g ?%* (%?l?%l&%c?)"
set folder_format="%4N %f"              # what I settled on

set pager_index_lines = 10              # Split-screen index/pager preview thing
set pager_stop = yes                    # Don't skip to next message at end of message
                                        # (avoids accidental setting as being read)
set markers = no                        # no line wraparound marker (is "+" by default)
set auto_tag = yes                      # Apply action on tagged message (index only)
set abort_nosubject = yes               # Don't send mail without subject
set metoo = no                          # remove my address when replying

set attach_keyword = "\\<(attach|attached|attachments?|joints|jointes|ci-joins|joignons)\\>"
set abort_noattach = ask-yes

set maildir_header_cache_verify = no
set header_cache = "~/.mutt/cache/headers"
set message_cachedir = "~/.mutt/cache/messages"
set mailcap_path = "~/.mutt/mailcap"      # override system mailcap
set certificate_file = "~/.mutt/certificates"

folder-hook . 'set record="^"'                    # Put sent mail into current folder
folder-hook . push '<collapse-all>'               # No open old threads

alternative_order text/plain text/html  # this helps with multipart messages
auto_view text/html                     #if there is only html dump that

# Contacts
set query_command = "khard email -p %s"
bind editor <Tab> complete-query
bind editor ^T    complete

set sidebar_width=22
set sidebar_visible=yes
set sidebar_divider_char='|'
set sidebar_short_path=yes
set sidebar_format='%B%?F? [%F]?%*   %?N?%N/?%S'

# Headers
ignore *
unignore Date: From: Organization: To: Cc: Reply-To: Subject:
unignore x-mailing-list: posted-to: x-beenthere:
unignore x-mailer: user-agent:
unignore X-Gerrit-ChangeURL:
hdr_order Date: Subject: From: To: Cc:  Reply-To: Organization:

set my_ttnn_user=`echo ${TTNN_USER}`
set my_account=`echo ${ACCOUNT:=sileht}`
source ~/.mutt/password
source ~/.mutt/account.$my_account

set spoolfile="=INBOX"
set record="=Sent"
set postponed="=Drafts"
set trash="=Trash"

#macro index <f1> '<sync-mailbox><redraw-screen><enter-command>source ~/.mutt/account.sileht<enter><redraw-screen><change-folder>!<enter><enter-command>exec sidebar-scroll-up<enter>'
#macro index <f2> '<sync-mailbox><redraw-screen><enter-command>source ~/.mutt/account.redhat<enter><redraw-screen><change-folder>!<enter><enter-command>exec sidebar-scroll-up<enter>'
#macro index <f3> '<sync-mailbox><redraw-screen><enter-command>set my_ttnn_user=adhesion<enter><enter-command>source ~/.mutt/account.ttnn<enter><redraw-screen><change-folder>!<enter><enter-command>exec sidebar-scroll-up<enter>'
#macro index <f4> '<sync-mailbox><redraw-screen><enter-command>set my_ttnn_user=common<enter><enter-command>source ~/.mutt/account.ttnn<enter><redraw-screen><change-folder>!<enter><enter-command>exec sidebar-scroll-up<enter>'
