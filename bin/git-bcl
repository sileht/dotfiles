#!/bin/bash

git fetch origin
branches_to_delete="$((git branch --merged origin/master ; git branch --merged origin/stable/liberty ; git branch --merged origin/stable/kilo) | grep -v '\<master\>'; git branch -l | grep '^\s*review')"

if [ ! "$branches_to_delete" ]; then
    echo "Nothing found..."
    exit 0
fi
echo $branches_to_delete
for branch in $branches_to_delete; do 
    git log -1 --pretty=tformat:'%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%an %cr)%Creset' --date=relative $branch
done

read -p"Continue (Y/O/N)? " 
case $REPLY in
    Y|y|yes|Yes|YES|YEs|O) git branch -D $branches_to_delete ;;
    *) echo "Abandoning..." ;;
esac
